<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:fragment="header (template, menu)">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <!--<meta name="referrer" content="unsafe-url">-->
    <title>Магазин-мастерская Цифровой Центр</title>

    <!-- Google Fonts -->
    <link href='https://fonts.googleapis.com/css?family=Titillium+Web:400,200,300,700,600' rel='stylesheet'
          type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300' rel='stylesheet' type='text/css'/>
    <link href='https://fonts.googleapis.com/css?family=Raleway:400,100' rel='stylesheet' type='text/css'/>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

    <link rel="shortcut icon" href="/resources/img/icon.ico">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/resources/css/owl.carousel.css"/>
    <link rel="stylesheet" href="/resources/css/style.1.1.8.css"/>
    <link rel="stylesheet" href="/resources/css/responsive.1.0.4.css"/>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body th:with="isUser = ${#httpServletRequest.isUserInRole('USER')}, isAdmin = ${#httpServletRequest.isUserInRole('ADMIN')}">

<th:block th:with="isUserOrAdmin = ${isUser or isAdmin}">
    <div class="header-area">
        <div class="container">
            <div class="row">
                <div class="login-registr">
                    <th:block th:unless="${isUserOrAdmin}">
                        <a href="/users/login">
                            <i class="fa fa-user"></i> Вход
                        </a>
                        <!--<span>/</span>
                        <a href="/users/registration"> Регистрация</a>-->
                    </th:block>
                    <th:block th:if="${isUserOrAdmin}">
                        <a th:if="${isAdmin}" href="https://cifraadmin.herokuapp.com" target="_blank">Spring Admin </a>
                        <span>/ </span>
                        <a href="/users/account">
                            <i class="fa fa-user"></i> Аккаунт
                        </a>
                        <span>/</span>
                        <a href="/users/logout"> Выход</a>
                    </th:block>
                </div>
            </div>
        </div>
    </div>
</th:block>

<!--/*@thymesVar id="utils" type="com.example.utils.UtilsForWeb"*/-->
<div class="site-branding-area">
    <div class="container">
        <div class="row">
            <div class="col-sm-7">
                <div class="logo">
                    <a href="/index">
                        <img src="/resources/img/logo.png"/>
                    </a>
                </div>
            </div>
            <div class="col-sm-5">
                <div class="q-phone-block">
                    <p class="number">+7 (983) 583-2000</p>
                    <div class="headerCallback"><a data-target="#headerCallback" data-toggle="modal" class="showCallbackPopup" onclick="return false">заказать
                        обратный звонок</a></div>
                </div>
            </div>

        </div>
    </div>
</div> <!-- End site branding area -->

<div class="mainmenu-area">
    <div class="container">
        <div class="row">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>

            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li th:class="${menu}=='fix'?'active':''"><a href="/fix">Мастерская</a></li>
                    <li th:class="${menu}=='status'?'active':''"><a href="/orders/widget">Статус заказа/ремонта</a></li>
                    <li th:class="${menu}=='contacts'?'active':''"><a href="/contacts">Контакты</a></li>
                    <li th:if="${isAdmin}" th:class="${menu}=='admin_callbacks'?'active':''"><a href="/admin/callbacks">Коллбэки</a></li>
                </ul>
            </div>
        </div>
    </div>
</div> <!-- End mainmenu area -->

<div th:replace="${template}"></div>

<div class="footer-top-area">
    <div class="zigzag-bottom"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-4 col-sm-6">
                <div class="footer-about-us">
                    <h2 class="footer-wid-title">Цифровой центр</h2>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Perferendis sunt id doloribus vero quam
                        laborum quas alias dolores blanditiis iusto consequatur, modi aliquid eveniet eligendi iure
                        eaque ipsam iste, pariatur omnis sint! Suscipit, debitis, quisquam. Laborum commodi veritatis
                        magni at?</p>
                    <div class="footer-social">
                        <a href="#" target="_blank"><i class="fab fa-vk"></i></a>
                        <a href="#" target="_blank"><i class="fab fa-odnoklassniki"></i></a>
                        <a href="#" target="_blank"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>

            <div class="col-md-4 col-sm-6">
                <div class="footer-menu">
                    <h2 class="footer-wid-title">Навигация пользователя </h2>
                    <ul>
                        <li><a href="#">Политика конфидециальности</a></li><!--privacy_policy-->
                        <li><a href="#">Обмен и возврат товара</a></li><!--exchange_and_returns-->
                    </ul>
                </div>
            </div>

            <div class="col-md-4 col-sm-6" th:if="${!isUser}">
                <div class="footer-newsletter">
                    <h2 class="footer-wid-title">Подписка</h2>
                    <p>Узнавайте о новостях и акциях первыми. Получайте индивидуальные предложения и скидки</p>
                    <div class="newsletter-form">
                        <input type="email" placeholder="Введите ваш email">
                        <input type="submit" value="Подписаться">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="footer-bottom-area">
    <div class="container">
        <div class="row">
            <div class="col-md-8">
                <div class="copyright">
                    <p>&copy; 2018 Cifracentr. Все права защищены.</p>
                    <!--Coded with love by keni0k-->
                </div>
            </div>

            <div class="col-md-4">
                <div class="footer-card-icon">
                    <i class="fab fa-cc-discover"></i>
                    <i class="fab fa-cc-mastercard"></i>
                    <i class="fab fa-cc-paypal"></i>
                    <i class="fab fa-cc-visa"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<div th:replace="fragments/headerCallback :: model">%%</div>
<th:block th:if="${#httpServletRequest.getParameter('msg')!=null and #httpServletRequest.getParameter('msg')!=''}">
    <div th:replace="fragments/response :: modal">%%</div>
</th:block>

<!-- Latest jQuery form server -->
<!--<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"-->
        <!--integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" th:if="${menu=='order_widget' or menu=='admin_callbacks'}"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>-->

<script type="text/javascript" th:if="${#httpServletRequest.getParameter('msg')!=null and #httpServletRequest.getParameter('msg')!=''}">
    $(window).on('load',function(){
        $('#msg_modal').modal('show');
    });
</script>

<!-- jQuery sticky menu -->
<script src="/resources/js/owl.carousel.min.js"></script>
<script src="/resources/js/jquery.sticky.js"></script>

<!-- jQuery easing -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>

<!-- Main Script -->
<script src="/resources/js/main.js"></script>
<!--<th:block th:if="${menu=='registration'}">-->
    <script src="/resources/js/masked_input.min.js"></script>
    <script>$(document).ready(function () {
        $("#phone_number").mask("+7 (999) 999-9999");
        $("#phone_callback").mask("+7 (999) 999-9999");
    });</script>
<!--</th:block>-->

<th:block th:if="${menu=='add_product'}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.12.4/dist/js/bootstrap-select.min.js"></script>
    <script type="text/javascript" src="/resources/js/Sortable.min.js"></script>
    <script th:inline="javascript">/*<![CDATA[*/
    function setimage() {
        var max = 5 - $('.upload-img').length;
        if (max <= 0) {
            alert('Максимально количество фотографий = 4!');
            return;
        }
        var $input = $("#upload_input");
        var id = [[${inputProduct.getId()}]];
        var $url = '/upload_images';
        var inputFile = document.getElementById('upload_input').files;
        for (var i = 0; i < inputFile.length; i++) {
            var fd = new FormData;
            if (i > max - 1) {
                alert('Максимально количество фотографий = 4!');
                break;
            }
            fd.append('img', $input.prop('files')[i]);
            $.ajax({
                url: $url,
                data: fd,
                processData: false,
                contentType: false,
                type: 'POST',
                success: function (data) {
                    var final = '<div class="upload-img"><img src="' + data + '" class="img-rounded"/>"' + '"<div class="closer" onclick="remove_img($(this));"></div></div>';
                    var $result = $('#result');
                    var $demoImg = $('#demo-img');
                    if ($result.children().length < 4) $result.append(final);
                    if ($result.children('.upload-img').length >= 4) $('#add-photo').css('display', 'none');
                    var src = $result.find('div:first-child img:first-child').attr('src');
                    if ($demoImg.attr('src') !== src) $demoImg.attr("src", src);
                },
                error: function (data) {
                    alert("Не все фотографии загрузились. Повторите, пожалуйста, попытку.");
                }
            });
        }
    }

    /*]]>*/
    </script>
</th:block>

</body>
</html>